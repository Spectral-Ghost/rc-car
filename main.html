<!-- Firebase SDKs -->
<script type="module">
  // Import the functions you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

  // Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyB79wb5DsH69pOQw35Nk2hg96_Xz0mEfWY",
    authDomain: "rccar-2b355.firebaseapp.com",
    databaseURL: "https://rccar-2b355-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "rccar-2b355",
    storageBucket: "rccar-2b355.firebasestorage.app",
    messagingSenderId: "505701251853",
    appId: "1:505701251853:web:de2fbbd641e33dfd348e44"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  let speed = 150;

  // Update speed from slider
  function updateSpeed(val){
    speed = val;
    document.getElementById('speedValue').innerText = val;
    set(ref(db, '/speed'), val);
  }

  // Send command to Firebase
  function sendCommand(cmd){
    set(ref(db, '/command'), cmd);
  }

  function stopCommand(){
    set(ref(db, '/command'), "");
  }

  // Hold button functionality
  function holdButton(buttonId, command){
    const btn = document.getElementById(buttonId);
    btn.addEventListener('mousedown', ()=>sendCommand(command));
    btn.addEventListener('mouseup', stopCommand);
    btn.addEventListener('mouseleave', stopCommand);
    btn.addEventListener('touchstart', ()=>sendCommand(command));
    btn.addEventListener('touchend', stopCommand);
  }

  // Assign buttons
  holdButton('btnForward', 'forward');
  holdButton('btnBackward', 'backward');
  holdButton('btnLeft', 'left');
  holdButton('btnRight', 'right');
  holdButton('btnStop', 'stop');
</script>
